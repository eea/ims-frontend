version: '3'

services:
  frontend:
    image: eeacms/ims-frontend:develop
    ports:
    - "${FRONTEND:-3000}:3000"
    depends_on:
    - backend
    environment:
      API_PATH: "http://localhost:${BACKEND:-8080}/Plone"
      INTERNAL_API_PATH: "http://backend:${BACKEND:-8080}/Plone"
      RAZZLE_API_PATH: "http://localhost:${BACKEND:-8080}/Plone"
      RAZZLE_INTERNAL_API_PATH: "http://backend:${BACKEND:-8080}/Plone"
      REBUILD: "True"
    volumes:
    - ./src/addons:/opt/frontend/src/addons

  backend:
    image: plone
    ports:
    - "${BACKEND:-8080}:8080"
    environment:
      PROFILES: "kitconcept.volto:default-homepage eea.geolocation:default eea.progress.workflow:default eea.zotero:default"
      ADDONS: "kitconcept.volto eea.geolocation eea.progress.workflow eea.zotero"
      SITE: "Plone"
    volumes:
    - data:/data

volumes:
  data:
    driver: local
